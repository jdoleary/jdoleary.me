parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"D9Nj":[function(require,module,exports) {

},{}],"NKbW":[function(require,module,exports) {
"use strict";function r(){return{r:Math.floor(e(0,255)),g:Math.floor(e(0,255)),b:Math.floor(e(0,255))}}function e(r,e){return Math.random()*(e-r)+r}Object.defineProperty(exports,"__esModule",{value:!0}),exports.rand_color=r,exports.rand_between=e;
},{}],"lXla":[function(require,module,exports) {
const e={Data:"Data",Rooms:"Rooms",ClientPresenceChanged:"ClientPresenceChanged",ServerAssignedData:"ServerAssignedData",Err:"Err",ResolvePromise:"ResolvePromise",RejectPromise:"RejectPromise",MakeRoom:"MakeRoom",JoinRoom:"JoinRoom",LeaveRoom:"LeaveRoom",GetRooms:"GetRooms",ConnectInfo:"ConnectInfo"},o={Together:"Together"};module.exports={MessageType:e,DataSubType:o};
},{}],"webP":[function(require,module,exports) {
const{MessageType:e}=require("./enums");class t{constructor({env:t="development",wsUri:o,onData:s,onError:n,onServerAssignedData:r,onClientPresenceChanged:i,onRooms:c,onConnectInfo:a}){this.env=t,this.wsUri=o,this.onData=s,this.onError=n||console.error,this.onServerAssignedData=r,this.onClientPresenceChanged=i,this.onRooms=c,this.onConnectInfo=a,this.connected=!1,this.promiseCBs={makeRoom:null,joinRoom:null},this.statusElement=document.querySelector("#websocket-pie-connection-status"),this.statusElement&&(this.statusElement.style["pointer-events"]="none",this.statusElement.style.position="absolute",this.statusElement.style.top="10px",this.statusElement.style.left="10px",this.statusElement.style["user-select"]="none"),this.ws=new WebSocket(o),this.ws.onmessage=(t=>{try{const s=JSON.parse(t.data);switch(s.type){case e.Data:this.onData(s);break;case e.ResolvePromise:this.promiseCBs[s.func]&&this.promiseCBs[s.func].resolve();break;case e.RejectPromise:this.promiseCBs[s.func]&&this.promiseCBs[s.func].reject(s.err);break;case e.ServerAssignedData:this.onServerAssignedData&&this.onServerAssignedData(s);break;case e.ClientPresenceChanged:this._updateDebugInfo(s),this.onClientPresenceChanged&&this.onClientPresenceChanged(s);break;case e.Rooms:this.onRooms&&this.onRooms(s);break;case e.Err:console.error(s),this.onError(s);break;default:console.log(s),console.error(`Above message of type ${s.type} not recognized!`)}}catch(o){console.error(o),this.onError(o)}}),this.ws.onopen=(()=>{this.connected=!0,this._updateDebugInfo(),this.onConnectInfo&&this.onConnectInfo({type:e.ConnectInfo,connected:this.connected,msg:`Opened connection to ${this.wsUri}`})}),this.ws.onclose=(()=>{this.connected=!1,this._updateDebugInfo(),this.onConnectInfo&&this.onConnectInfo({type:e.ConnectInfo,connected:this.connected,msg:`Connection to ${this.wsUri} closed.`})})}makeRoom(t){return this.connected?(this.promiseCBs[e.MakeRoom]&&this.promiseCBs[e.MakeRoom].reject({msg:"Cancelled due to newer makeRoom request"}),new Promise((o,s)=>{this.promiseCBs[e.MakeRoom]={resolve:o,reject:s},this.ws.send(JSON.stringify({type:e.MakeRoom,roomInfo:t}))})):Promise.reject({msg:"Cannot make room, not currently connected to web socket server"})}joinRoom(t){return this.connected?(this.promiseCBs[e.JoinRoom]&&this.promiseCBs[e.JoinRoom].reject({msg:"Cancelled due to newer joinRoom request"}),new Promise((o,s)=>{this.promiseCBs[e.JoinRoom]={resolve:o,reject:s},this.ws.send(JSON.stringify({type:e.JoinRoom,roomInfo:t}))})):Promise.reject({msg:"Cannot join room, not currently connected to web socket server"})}leaveRoom(){this.connected?this.ws.send(JSON.stringify({type:e.LeaveRoom})):this.onError({msg:"Cannot leave room, not currently connected to web socket server"})}getRooms(t){this.connected?this.ws.send(JSON.stringify({type:e.GetRooms,roomInfo:t})):this.onError({msg:"Cannot get rooms, not currently connected to web socket server"})}sendData(t,o){this.connected?this.ws.send(JSON.stringify({type:e.Data,payload:t,...o})):this.onError({msg:"Cannot send data to room, not currently connected to web socket server"})}_updateDebugInfo(e){try{if(this.statusElement){if(this.connected){const t=e&&e.clients&&e.clients.length||1;this.statusElement.innerHTML=`⬤ ${1==t?`${t} User`:`${t} Users`} Connected`}else this.statusElement.innerHTML="⬤ Disconnected";this.statusElement.style.color=this.connected?"green":"red"}}catch(t){console.error(t)}}}module.exports=t;
},{"./enums":"lXla"}],"OZIk":[function(require,module,exports) {
const e=require("./src/PieClient");module.exports=e;
},{"./src/PieClient":"webP"}],"rHQn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.connect=t,exports.pie=void 0;var e,o=n(require("pie-client"));function n(e){return e&&e.__esModule?e:{default:e}}function t(n){exports.pie=e=new o.default({wsUri:"wss://websocket-pie-e4elx.ondigitalocean.app/",onData:n,onConnectInfo:function(o){o.connected&&e.makeRoom(r).catch(function(){return e.joinRoom(r)}).then(function(){return console.log("You are now in the room")}).catch(function(e){return console.log("Failed to join room",e)})}})}exports.pie=e;var r={app:"fireworks_demo",version:"0.1.0"};
},{"pie-client":"OZIk"}],"H99C":[function(require,module,exports) {
"use strict";require("./styles.css");var n=require("./util.js"),e=require("./network.js");function t(n,e){var t;if("undefined"==typeof Symbol||null==n[Symbol.iterator]){if(Array.isArray(n)||(t=r(n))||e&&n&&"number"==typeof n.length){t&&(n=t);var o=0,i=function(){};return{s:i,n:function(){return o>=n.length?{done:!0}:{done:!1,value:n[o++]}},e:function(n){throw n},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,l=!1;return{s:function(){t=n[Symbol.iterator]()},n:function(){var n=t.next();return c=n.done,n},e:function(n){l=!0,a=n},f:function(){try{c||null==t.return||t.return()}finally{if(l)throw a}}}}function r(n,e){if(n){if("string"==typeof n)return o(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(n):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?o(n,e):void 0}}function o(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}var i=16,a=.25/i,c=20,l=[],f=[],u=document.getElementById("canvas");function y(){u.width=window.innerWidth,u.height=window.innerHeight}window.onresize=y,y();var v=u.getContext("2d"),s=(0,n.rand_color)(),d=s.r,h=s.g,g=s.b;function m(n){p(n),v.clearRect(0,0,u.width,u.height);var e,r=t(l);try{for(r.s();!(e=r.n()).done;){var o=e.value;b(o.c),v.fillRect(o.x,o.y,10,10)}}catch(y){r.e(y)}finally{r.f()}var i,a=t(f);try{for(a.s();!(i=a.n()).done;){var c=i.value;b(c.c),v.fillRect(c.x,c.y,10,10)}}catch(y){a.e(y)}finally{a.f()}requestAnimationFrame(m)}function b(n){if(n){var e=n.r,t=n.g,r=n.b;v.fillStyle="rgb("+e+","+t+","+r+")"}}v.fillStyle="rgb("+d+","+h+","+g+")",u.addEventListener("mousedown",function(n){S(n.offsetX,n.offsetY)});var w=0;function p(n){var e=n-w;w=n;for(var t=l.length;t>=0;t--){var r=l[t];if(r&&(r.x+=e*r.vx,r.vy+=a,r.y+=e*r.vy,r.vy>0)){l.splice(t,1);for(var o=0;o<c;o++)x(r.x,r.y,r.c)}}for(var i=f.length;i>=0;i--){var y=f[i];y&&(y.x+=e*y.vx,y.vy+=a,y.y+=e*y.vy,y.y>u.height&&f.splice(i,1))}}function x(e,t,r){var o=(0,n.rand_between)(-10/i,10/i),a=(0,n.rand_between)(-10/i,0);f.push({x:e,y:t,vx:o,vy:a,c:r})}function A(e,t){l.push({x:e,y:t,vx:0,vy:-15/i,c:(0,n.rand_color)()})}function S(n,t){e.pie.connected?e.pie.sendData({x:n,y:t}):A(n,t)}function j(n){console.log("onData -> message",n);var e=n.payload;A(e.x,e.y)}requestAnimationFrame(m),(0,e.connect)(j);
},{"./styles.css":"D9Nj","./util.js":"NKbW","./network.js":"rHQn"}]},{},["H99C"], null)
//# sourceMappingURL=https://jordanoleary.me/projects/fireworks/src.a0083fdb.js.map